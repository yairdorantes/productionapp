{"ast":null,"code":"var _jsxFileName = \"/home/yair/Desktop/project/src/components/Posts.js\",\n    _s = $RefreshSig$();\n\nimport { useContext, useEffect, useState } from \"react\";\nimport Heart from \"react-heart\";\nimport Loader from \"./Loader\";\nimport { helpHttp } from \"../helpers/helpHttp\";\nimport AuthContext from \"../context/AuthContext\";\nimport PostPage from \"./PostPage\";\nimport { Link } from \"react-router-dom\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nlet url = `http://127.0.0.1:8000/api/postset/`;\nlet like = \"http://127.0.0.1:8000/api/posts/\";\nconst params = {\n  method: \"GET\",\n  headers: {\n    accept: \"application/json\"\n  }\n};\n\nconst Posts = () => {\n  _s();\n\n  let {\n    user\n  } = useContext(AuthContext);\n  let likedPosts = `http://127.0.0.1:8000/api/posts/${user.user_id}`;\n  const [likes, setLikes] = useState([]);\n  const [posts, setPosts] = useState();\n\n  const fetchAPi = async () => {\n    const response = await fetch(url, params);\n    const responseJSON = await response.json();\n    setPosts(responseJSON); // console.log(responseJSON);\n  };\n\n  const getLikedPosts = async () => {\n    const response = await fetch(likedPosts, params);\n    const responseJSON = await response.json(); // setPosts(responseJSON);\n    // console.log(\"liked\", responseJSON);\n\n    responseJSON.posts_liked_by_user.map(post => likes.push(post.id));\n    setLikes([...likes]);\n  };\n\n  useEffect(() => {\n    fetchAPi();\n    getLikedPosts();\n  }, []);\n\n  const handleLike = post => {\n    let index = likes.findIndex(x => x === post.id);\n\n    if (index >= 0) {\n      likes.splice(index, 1);\n      post.likes_count -= 1;\n      let options = {\n        body: {\n          is_like: false,\n          id: post.id,\n          user_id: user.user_id\n        },\n        headers: {\n          \"content-type\": \"application/json\"\n        }\n      };\n      helpHttp().post(like, options).then(res => console.log(res.message));\n    } else {\n      likes.push(post.id);\n      post.likes_count += 1;\n      let options = {\n        body: {\n          is_like: true,\n          id: post.id,\n          user_id: user.user_id\n        },\n        headers: {\n          \"content-type\": \"application/json\"\n        }\n      };\n      helpHttp().post(like, options).then(res => console.log(res.message));\n    }\n\n    setLikes([...likes]); // console.log(likes);\n  };\n\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"container-posts\",\n      children: !posts ? /*#__PURE__*/_jsxDEV(Loader, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 76,\n        columnNumber: 11\n      }, this) : posts.map(post => {\n        return /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"card-post\",\n          children: [/*#__PURE__*/_jsxDEV(Link, {\n            to: `/postpage/${post.id}`,\n            className: \"link-post\",\n            children: [/*#__PURE__*/_jsxDEV(\"img\", {\n              className: \"image-post\",\n              src: post.image_src,\n              alt: \"Avatar\",\n              style: {\n                width: \"100%\",\n                maxHeight: \"100px\"\n              }\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 82,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              style: {\n                backgroundColor: `${post.categoria.color}`\n              },\n              className: \"section-post\",\n              children: post.categoria.name\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 88,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"container-card-text\",\n              children: /*#__PURE__*/_jsxDEV(\"h4\", {\n                children: /*#__PURE__*/_jsxDEV(\"b\", {\n                  children: post.title\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 96,\n                  columnNumber: 23\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 95,\n                columnNumber: 21\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 94,\n              columnNumber: 19\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 81,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"like-post\",\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"heart-box\",\n              children: [likes.findIndex(x => x === post.id) >= 0 ? /*#__PURE__*/_jsxDEV(Heart, {\n                onClick: handleLike.bind(this, post),\n                style: {\n                  width: \"20px\"\n                },\n                isActive: true\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 104,\n                columnNumber: 23\n              }, this) : /*#__PURE__*/_jsxDEV(Heart, {\n                onClick: handleLike.bind(this, post),\n                style: {\n                  width: \"20px\"\n                },\n                isActive: false\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 110,\n                columnNumber: 23\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"number-likes-post\",\n                children: [post.likes_count, \" Likes\"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 116,\n                columnNumber: 21\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 102,\n              columnNumber: 19\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 101,\n            columnNumber: 17\n          }, this)]\n        }, post.id, true, {\n          fileName: _jsxFileName,\n          lineNumber: 80,\n          columnNumber: 15\n        }, this);\n      })\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 74,\n      columnNumber: 7\n    }, this)\n  }, void 0, false);\n};\n\n_s(Posts, \"TTSb8FkyjaFvD/edubBIGk8HNRk=\");\n\n_c = Posts;\nexport default Posts;\n\nvar _c;\n\n$RefreshReg$(_c, \"Posts\");","map":{"version":3,"names":["useContext","useEffect","useState","Heart","Loader","helpHttp","AuthContext","PostPage","Link","url","like","params","method","headers","accept","Posts","user","likedPosts","user_id","likes","setLikes","posts","setPosts","fetchAPi","response","fetch","responseJSON","json","getLikedPosts","posts_liked_by_user","map","post","push","id","handleLike","index","findIndex","x","splice","likes_count","options","body","is_like","then","res","console","log","message","image_src","width","maxHeight","backgroundColor","categoria","color","name","title","bind"],"sources":["/home/yair/Desktop/project/src/components/Posts.js"],"sourcesContent":["import { useContext, useEffect, useState } from \"react\";\nimport Heart from \"react-heart\";\nimport Loader from \"./Loader\";\nimport { helpHttp } from \"../helpers/helpHttp\";\nimport AuthContext from \"../context/AuthContext\";\nimport PostPage from \"./PostPage\";\nimport { Link } from \"react-router-dom\";\nlet url = `http://127.0.0.1:8000/api/postset/`;\nlet like = \"http://127.0.0.1:8000/api/posts/\";\nconst params = {\n  method: \"GET\",\n  headers: {\n    accept: \"application/json\",\n  },\n};\nconst Posts = () => {\n  let { user } = useContext(AuthContext);\n  let likedPosts = `http://127.0.0.1:8000/api/posts/${user.user_id}`;\n\n  const [likes, setLikes] = useState([]);\n\n  const [posts, setPosts] = useState();\n\n  const fetchAPi = async () => {\n    const response = await fetch(url, params);\n    const responseJSON = await response.json();\n    setPosts(responseJSON);\n    // console.log(responseJSON);\n  };\n\n  const getLikedPosts = async () => {\n    const response = await fetch(likedPosts, params);\n    const responseJSON = await response.json();\n    // setPosts(responseJSON);\n    // console.log(\"liked\", responseJSON);\n    responseJSON.posts_liked_by_user.map((post) => likes.push(post.id));\n    setLikes([...likes]);\n  };\n\n  useEffect(() => {\n    fetchAPi();\n    getLikedPosts();\n  }, []);\n\n  const handleLike = (post) => {\n    let index = likes.findIndex((x) => x === post.id);\n    if (index >= 0) {\n      likes.splice(index, 1);\n      post.likes_count -= 1;\n      let options = {\n        body: { is_like: false, id: post.id, user_id: user.user_id },\n        headers: { \"content-type\": \"application/json\" },\n      };\n      helpHttp()\n        .post(like, options)\n        .then((res) => console.log(res.message));\n    } else {\n      likes.push(post.id);\n      post.likes_count += 1;\n      let options = {\n        body: { is_like: true, id: post.id, user_id: user.user_id },\n        headers: { \"content-type\": \"application/json\" },\n      };\n      helpHttp()\n        .post(like, options)\n        .then((res) => console.log(res.message));\n    }\n    setLikes([...likes]);\n    // console.log(likes);\n  };\n\n  return (\n    <>\n      <div className=\"container-posts\">\n        {!posts ? (\n          <Loader></Loader>\n        ) : (\n          posts.map((post) => {\n            return (\n              <div key={post.id} className=\"card-post\">\n                <Link to={`/postpage/${post.id}`} className=\"link-post\">\n                  <img\n                    className=\"image-post\"\n                    src={post.image_src}\n                    alt=\"Avatar\"\n                    style={{ width: \"100%\", maxHeight: \"100px\" }}\n                  />\n                  <div\n                    style={{ backgroundColor: `${post.categoria.color}` }}\n                    className=\"section-post\"\n                  >\n                    {post.categoria.name}\n                  </div>\n                  <div className=\"container-card-text\">\n                    <h4>\n                      <b>{post.title}</b>\n                    </h4>\n                  </div>\n                </Link>\n\n                <div className=\"like-post\">\n                  <div className=\"heart-box\">\n                    {likes.findIndex((x) => x === post.id) >= 0 ? (\n                      <Heart\n                        onClick={handleLike.bind(this, post)}\n                        style={{ width: \"20px\" }}\n                        isActive={true}\n                      />\n                    ) : (\n                      <Heart\n                        onClick={handleLike.bind(this, post)}\n                        style={{ width: \"20px\" }}\n                        isActive={false}\n                      />\n                    )}\n                    <div className=\"number-likes-post\">\n                      {post.likes_count} Likes\n                    </div>\n                  </div>\n                </div>\n              </div>\n            );\n          })\n        )}\n      </div>\n    </>\n  );\n};\n\nexport default Posts;\n"],"mappings":";;;AAAA,SAASA,UAAT,EAAqBC,SAArB,EAAgCC,QAAhC,QAAgD,OAAhD;AACA,OAAOC,KAAP,MAAkB,aAAlB;AACA,OAAOC,MAAP,MAAmB,UAAnB;AACA,SAASC,QAAT,QAAyB,qBAAzB;AACA,OAAOC,WAAP,MAAwB,wBAAxB;AACA,OAAOC,QAAP,MAAqB,YAArB;AACA,SAASC,IAAT,QAAqB,kBAArB;;;AACA,IAAIC,GAAG,GAAI,oCAAX;AACA,IAAIC,IAAI,GAAG,kCAAX;AACA,MAAMC,MAAM,GAAG;EACbC,MAAM,EAAE,KADK;EAEbC,OAAO,EAAE;IACPC,MAAM,EAAE;EADD;AAFI,CAAf;;AAMA,MAAMC,KAAK,GAAG,MAAM;EAAA;;EAClB,IAAI;IAAEC;EAAF,IAAWhB,UAAU,CAACM,WAAD,CAAzB;EACA,IAAIW,UAAU,GAAI,mCAAkCD,IAAI,CAACE,OAAQ,EAAjE;EAEA,MAAM,CAACC,KAAD,EAAQC,QAAR,IAAoBlB,QAAQ,CAAC,EAAD,CAAlC;EAEA,MAAM,CAACmB,KAAD,EAAQC,QAAR,IAAoBpB,QAAQ,EAAlC;;EAEA,MAAMqB,QAAQ,GAAG,YAAY;IAC3B,MAAMC,QAAQ,GAAG,MAAMC,KAAK,CAAChB,GAAD,EAAME,MAAN,CAA5B;IACA,MAAMe,YAAY,GAAG,MAAMF,QAAQ,CAACG,IAAT,EAA3B;IACAL,QAAQ,CAACI,YAAD,CAAR,CAH2B,CAI3B;EACD,CALD;;EAOA,MAAME,aAAa,GAAG,YAAY;IAChC,MAAMJ,QAAQ,GAAG,MAAMC,KAAK,CAACR,UAAD,EAAaN,MAAb,CAA5B;IACA,MAAMe,YAAY,GAAG,MAAMF,QAAQ,CAACG,IAAT,EAA3B,CAFgC,CAGhC;IACA;;IACAD,YAAY,CAACG,mBAAb,CAAiCC,GAAjC,CAAsCC,IAAD,IAAUZ,KAAK,CAACa,IAAN,CAAWD,IAAI,CAACE,EAAhB,CAA/C;IACAb,QAAQ,CAAC,CAAC,GAAGD,KAAJ,CAAD,CAAR;EACD,CAPD;;EASAlB,SAAS,CAAC,MAAM;IACdsB,QAAQ;IACRK,aAAa;EACd,CAHQ,EAGN,EAHM,CAAT;;EAKA,MAAMM,UAAU,GAAIH,IAAD,IAAU;IAC3B,IAAII,KAAK,GAAGhB,KAAK,CAACiB,SAAN,CAAiBC,CAAD,IAAOA,CAAC,KAAKN,IAAI,CAACE,EAAlC,CAAZ;;IACA,IAAIE,KAAK,IAAI,CAAb,EAAgB;MACdhB,KAAK,CAACmB,MAAN,CAAaH,KAAb,EAAoB,CAApB;MACAJ,IAAI,CAACQ,WAAL,IAAoB,CAApB;MACA,IAAIC,OAAO,GAAG;QACZC,IAAI,EAAE;UAAEC,OAAO,EAAE,KAAX;UAAkBT,EAAE,EAAEF,IAAI,CAACE,EAA3B;UAA+Bf,OAAO,EAAEF,IAAI,CAACE;QAA7C,CADM;QAEZL,OAAO,EAAE;UAAE,gBAAgB;QAAlB;MAFG,CAAd;MAIAR,QAAQ,GACL0B,IADH,CACQrB,IADR,EACc8B,OADd,EAEGG,IAFH,CAESC,GAAD,IAASC,OAAO,CAACC,GAAR,CAAYF,GAAG,CAACG,OAAhB,CAFjB;IAGD,CAVD,MAUO;MACL5B,KAAK,CAACa,IAAN,CAAWD,IAAI,CAACE,EAAhB;MACAF,IAAI,CAACQ,WAAL,IAAoB,CAApB;MACA,IAAIC,OAAO,GAAG;QACZC,IAAI,EAAE;UAAEC,OAAO,EAAE,IAAX;UAAiBT,EAAE,EAAEF,IAAI,CAACE,EAA1B;UAA8Bf,OAAO,EAAEF,IAAI,CAACE;QAA5C,CADM;QAEZL,OAAO,EAAE;UAAE,gBAAgB;QAAlB;MAFG,CAAd;MAIAR,QAAQ,GACL0B,IADH,CACQrB,IADR,EACc8B,OADd,EAEGG,IAFH,CAESC,GAAD,IAASC,OAAO,CAACC,GAAR,CAAYF,GAAG,CAACG,OAAhB,CAFjB;IAGD;;IACD3B,QAAQ,CAAC,CAAC,GAAGD,KAAJ,CAAD,CAAR,CAvB2B,CAwB3B;EACD,CAzBD;;EA2BA,oBACE;IAAA,uBACE;MAAK,SAAS,EAAC,iBAAf;MAAA,UACG,CAACE,KAAD,gBACC,QAAC,MAAD;QAAA;QAAA;QAAA;MAAA,QADD,GAGCA,KAAK,CAACS,GAAN,CAAWC,IAAD,IAAU;QAClB,oBACE;UAAmB,SAAS,EAAC,WAA7B;UAAA,wBACE,QAAC,IAAD;YAAM,EAAE,EAAG,aAAYA,IAAI,CAACE,EAAG,EAA/B;YAAkC,SAAS,EAAC,WAA5C;YAAA,wBACE;cACE,SAAS,EAAC,YADZ;cAEE,GAAG,EAAEF,IAAI,CAACiB,SAFZ;cAGE,GAAG,EAAC,QAHN;cAIE,KAAK,EAAE;gBAAEC,KAAK,EAAE,MAAT;gBAAiBC,SAAS,EAAE;cAA5B;YAJT;cAAA;cAAA;cAAA;YAAA,QADF,eAOE;cACE,KAAK,EAAE;gBAAEC,eAAe,EAAG,GAAEpB,IAAI,CAACqB,SAAL,CAAeC,KAAM;cAA3C,CADT;cAEE,SAAS,EAAC,cAFZ;cAAA,UAIGtB,IAAI,CAACqB,SAAL,CAAeE;YAJlB;cAAA;cAAA;cAAA;YAAA,QAPF,eAaE;cAAK,SAAS,EAAC,qBAAf;cAAA,uBACE;gBAAA,uBACE;kBAAA,UAAIvB,IAAI,CAACwB;gBAAT;kBAAA;kBAAA;kBAAA;gBAAA;cADF;gBAAA;gBAAA;gBAAA;cAAA;YADF;cAAA;cAAA;cAAA;YAAA,QAbF;UAAA;YAAA;YAAA;YAAA;UAAA,QADF,eAqBE;YAAK,SAAS,EAAC,WAAf;YAAA,uBACE;cAAK,SAAS,EAAC,WAAf;cAAA,WACGpC,KAAK,CAACiB,SAAN,CAAiBC,CAAD,IAAOA,CAAC,KAAKN,IAAI,CAACE,EAAlC,KAAyC,CAAzC,gBACC,QAAC,KAAD;gBACE,OAAO,EAAEC,UAAU,CAACsB,IAAX,CAAgB,IAAhB,EAAsBzB,IAAtB,CADX;gBAEE,KAAK,EAAE;kBAAEkB,KAAK,EAAE;gBAAT,CAFT;gBAGE,QAAQ,EAAE;cAHZ;gBAAA;gBAAA;gBAAA;cAAA,QADD,gBAOC,QAAC,KAAD;gBACE,OAAO,EAAEf,UAAU,CAACsB,IAAX,CAAgB,IAAhB,EAAsBzB,IAAtB,CADX;gBAEE,KAAK,EAAE;kBAAEkB,KAAK,EAAE;gBAAT,CAFT;gBAGE,QAAQ,EAAE;cAHZ;gBAAA;gBAAA;gBAAA;cAAA,QARJ,eAcE;gBAAK,SAAS,EAAC,mBAAf;gBAAA,WACGlB,IAAI,CAACQ,WADR;cAAA;gBAAA;gBAAA;gBAAA;cAAA,QAdF;YAAA;cAAA;cAAA;cAAA;YAAA;UADF;YAAA;YAAA;YAAA;UAAA,QArBF;QAAA,GAAUR,IAAI,CAACE,EAAf;UAAA;UAAA;UAAA;QAAA,QADF;MA4CD,CA7CD;IAJJ;MAAA;MAAA;MAAA;IAAA;EADF,iBADF;AAwDD,CAhHD;;GAAMlB,K;;KAAAA,K;AAkHN,eAAeA,KAAf"},"metadata":{},"sourceType":"module"}