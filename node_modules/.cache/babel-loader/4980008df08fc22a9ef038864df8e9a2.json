{"ast":null,"code":"import _toConsumableArray from\"/home/yair/Desktop/xd/EnglishApp-main/duolingoDjango/project/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _regeneratorRuntime from\"/home/yair/Desktop/xd/EnglishApp-main/duolingoDjango/project/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/home/yair/Desktop/xd/EnglishApp-main/duolingoDjango/project/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/home/yair/Desktop/xd/EnglishApp-main/duolingoDjango/project/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";var _this=this;import\"./styles/postCards.css\";import{useContext,useEffect,useState}from\"react\";import Heart from\"react-heart\";import Loader from\"./Loader\";import{helpHttp}from\"../helpers/helpHttp\";import AuthContext from\"../context/AuthContext\";import{Link}from\"react-router-dom\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var url=\"http://127.0.0.1:8000/api/postset/\";var like=\"http://127.0.0.1:8000/api/posts/\";var params={method:\"GET\",headers:{accept:\"application/json\"}};var Posts=function Posts(){var _useContext=useContext(AuthContext),user=_useContext.user;var likedPosts=\"http://127.0.0.1:8000/api/posts/\".concat(user.user_id);var _useState=useState([]),_useState2=_slicedToArray(_useState,2),likes=_useState2[0],setLikes=_useState2[1];var _useState3=useState(),_useState4=_slicedToArray(_useState3,2),posts=_useState4[0],setPosts=_useState4[1];var fetchAPi=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var response,responseJSON;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return fetch(url,params);case 2:response=_context.sent;_context.next=5;return response.json();case 5:responseJSON=_context.sent;setPosts(responseJSON);// console.log(responseJSON);\ncase 7:case\"end\":return _context.stop();}}},_callee);}));return function fetchAPi(){return _ref.apply(this,arguments);};}();var getLikedPosts=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(){var response,responseJSON;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return fetch(likedPosts,params);case 2:response=_context2.sent;_context2.next=5;return response.json();case 5:responseJSON=_context2.sent;// setPosts(responseJSON);\n// console.log(\"liked\", responseJSON);\nresponseJSON.posts_liked_by_user.map(function(post){return likes.push(post.id);});setLikes(_toConsumableArray(likes));case 8:case\"end\":return _context2.stop();}}},_callee2);}));return function getLikedPosts(){return _ref2.apply(this,arguments);};}();useEffect(function(){fetchAPi();getLikedPosts();},[]);var handleLike=function handleLike(post){var index=likes.findIndex(function(x){return x===post.id;});if(index>=0){likes.splice(index,1);post.likes_count-=1;var options={body:{is_like:false,id:post.id,user_id:user.user_id},headers:{\"content-type\":\"application/json\"}};helpHttp().post(like,options).then(function(res){return console.log(res.message);});}else{likes.push(post.id);post.likes_count+=1;var _options={body:{is_like:true,id:post.id,user_id:user.user_id},headers:{\"content-type\":\"application/json\"}};helpHttp().post(like,_options).then(function(res){return console.log(res.message);});}setLikes(_toConsumableArray(likes));// console.log(likes);\n};return/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsx(\"div\",{className:\"container-posts\",children:!posts?/*#__PURE__*/_jsx(Loader,{}):posts.map(function(post){return/*#__PURE__*/_jsxs(\"div\",{className:\"card-post\",children:[/*#__PURE__*/_jsxs(Link,{to:\"/postpage/\".concat(post.id),className:\"link-post\",children:[/*#__PURE__*/_jsx(\"img\",{className:\"image-post\",src:post.image_src,alt:\"Avatar\",style:{width:\"100%\",maxHeight:\"100px\"}}),/*#__PURE__*/_jsx(\"div\",{style:{backgroundColor:\"\".concat(post.categoria.color)},className:\"section-post\",children:post.categoria.name}),/*#__PURE__*/_jsx(\"div\",{className:\"container-card-text\",children:/*#__PURE__*/_jsx(\"h3\",{className:\"title-post-card\",children:post.title})})]}),/*#__PURE__*/_jsx(\"div\",{className:\"like-post\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"heart-box\",children:[likes.findIndex(function(x){return x===post.id;})>=0?/*#__PURE__*/_jsx(Heart,{onClick:handleLike.bind(_this,post),style:{width:\"20px\"},isActive:true}):/*#__PURE__*/_jsx(Heart,{onClick:handleLike.bind(_this,post),style:{width:\"20px\"},isActive:false}),/*#__PURE__*/_jsxs(\"div\",{className:\"number-likes-post\",children:[post.likes_count,\" Likes\"]})]})})]},post.id);})})});};export default Posts;","map":{"version":3,"names":["useContext","useEffect","useState","Heart","Loader","helpHttp","AuthContext","Link","url","like","params","method","headers","accept","Posts","user","likedPosts","user_id","likes","setLikes","posts","setPosts","fetchAPi","fetch","response","json","responseJSON","getLikedPosts","posts_liked_by_user","map","post","push","id","handleLike","index","findIndex","x","splice","likes_count","options","body","is_like","then","res","console","log","message","image_src","width","maxHeight","backgroundColor","categoria","color","name","title","bind"],"sources":["/home/yair/Desktop/xd/EnglishApp-main/duolingoDjango/project/src/components/Posts.js"],"sourcesContent":["import \"./styles/postCards.css\";\nimport { useContext, useEffect, useState } from \"react\";\nimport Heart from \"react-heart\";\nimport Loader from \"./Loader\";\nimport { helpHttp } from \"../helpers/helpHttp\";\nimport AuthContext from \"../context/AuthContext\";\nimport { Link } from \"react-router-dom\";\nlet url = `http://127.0.0.1:8000/api/postset/`;\nlet like = \"http://127.0.0.1:8000/api/posts/\";\nconst params = {\n  method: \"GET\",\n  headers: {\n    accept: \"application/json\",\n  },\n};\nconst Posts = () => {\n  let { user } = useContext(AuthContext);\n  let likedPosts = `http://127.0.0.1:8000/api/posts/${user.user_id}`;\n\n  const [likes, setLikes] = useState([]);\n\n  const [posts, setPosts] = useState();\n\n  const fetchAPi = async () => {\n    const response = await fetch(url, params);\n    const responseJSON = await response.json();\n    setPosts(responseJSON);\n    // console.log(responseJSON);\n  };\n\n  const getLikedPosts = async () => {\n    const response = await fetch(likedPosts, params);\n    const responseJSON = await response.json();\n    // setPosts(responseJSON);\n    // console.log(\"liked\", responseJSON);\n    responseJSON.posts_liked_by_user.map((post) => likes.push(post.id));\n    setLikes([...likes]);\n  };\n\n  useEffect(() => {\n    fetchAPi();\n    getLikedPosts();\n  }, []);\n\n  const handleLike = (post) => {\n    let index = likes.findIndex((x) => x === post.id);\n    if (index >= 0) {\n      likes.splice(index, 1);\n      post.likes_count -= 1;\n      let options = {\n        body: { is_like: false, id: post.id, user_id: user.user_id },\n        headers: { \"content-type\": \"application/json\" },\n      };\n      helpHttp()\n        .post(like, options)\n        .then((res) => console.log(res.message));\n    } else {\n      likes.push(post.id);\n      post.likes_count += 1;\n      let options = {\n        body: { is_like: true, id: post.id, user_id: user.user_id },\n        headers: { \"content-type\": \"application/json\" },\n      };\n      helpHttp()\n        .post(like, options)\n        .then((res) => console.log(res.message));\n    }\n    setLikes([...likes]);\n    // console.log(likes);\n  };\n\n  return (\n    <>\n      <div className=\"container-posts\">\n        {!posts ? (\n          <Loader></Loader>\n        ) : (\n          posts.map((post) => {\n            return (\n              <div key={post.id} className=\"card-post\">\n                <Link to={`/postpage/${post.id}`} className=\"link-post\">\n                  <img\n                    className=\"image-post\"\n                    src={post.image_src}\n                    alt=\"Avatar\"\n                    style={{ width: \"100%\", maxHeight: \"100px\" }}\n                  />\n                  <div\n                    style={{ backgroundColor: `${post.categoria.color}` }}\n                    className=\"section-post\"\n                  >\n                    {post.categoria.name}\n                  </div>\n                  <div className=\"container-card-text\">\n                    <h3 className=\"title-post-card\">{post.title}</h3>\n                  </div>\n                </Link>\n\n                <div className=\"like-post\">\n                  <div className=\"heart-box\">\n                    {likes.findIndex((x) => x === post.id) >= 0 ? (\n                      <Heart\n                        onClick={handleLike.bind(this, post)}\n                        style={{ width: \"20px\" }}\n                        isActive={true}\n                      />\n                    ) : (\n                      <Heart\n                        onClick={handleLike.bind(this, post)}\n                        style={{ width: \"20px\" }}\n                        isActive={false}\n                      />\n                    )}\n                    <div className=\"number-likes-post\">\n                      {post.likes_count} Likes\n                    </div>\n                  </div>\n                </div>\n              </div>\n            );\n          })\n        )}\n      </div>\n    </>\n  );\n};\n\nexport default Posts;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}