{"version":3,"file":"index.js","sources":["../src/useDetectClickOutside.tsx"],"sourcesContent":["import { useCallback, useEffect, useMemo, useRef } from 'react';\n\ninterface Props {\n  onTriggered: (e: Event) => void;\n  disableClick?: boolean;\n  disableTouch?: boolean;\n  disableKeys?: boolean;\n  allowAnyKey?: boolean;\n  triggerKeys?: string[];\n}\n\ntype EventConfigItem = [boolean | undefined, string, (e: Event) => void];\n\n/**\n * Hook used to detect clicks outside a component (or an escape key press). onTriggered function is triggered on `click`, `touch` or escape `keyup` event.\n *\n */\nexport function useDetectClickOutside({\n  onTriggered,\n  disableClick,\n  disableTouch,\n  disableKeys,\n  allowAnyKey,\n  triggerKeys,\n}: Props) {\n  const ref = useRef(null);\n\n  const keyListener = useCallback(\n    (e: KeyboardEvent) => {\n      if (allowAnyKey) {\n        onTriggered(e);\n      } else if (triggerKeys) {\n        if (triggerKeys.includes(e.key)) {\n          onTriggered(e);\n        }\n      } else {\n        if (e.key === 'Escape') {\n          onTriggered(e);\n        }\n      }\n    },\n    [allowAnyKey, triggerKeys, onTriggered]\n  );\n\n  const clickOrTouchListener = useCallback(\n    (e: MouseEvent | TouchEvent) => {\n      if (ref && ref.current) {\n        if (!(ref.current! as any).contains(e.target)) {\n          onTriggered?.(e);\n        }\n      }\n    },\n    [ref.current, onTriggered]\n  );\n\n  const eventsConfig: EventConfigItem[] = useMemo(\n    () => [\n      [disableClick, 'click', clickOrTouchListener],\n      [disableTouch, 'touchstart', clickOrTouchListener],\n      [disableKeys, 'keyup', keyListener],\n    ],\n    [disableClick, disableTouch, disableKeys, clickOrTouchListener, keyListener]\n  );\n\n  useEffect(() => {\n    eventsConfig.map((eventConfigItem) => {\n      const [isDisabled, eventName, listener] = eventConfigItem;\n\n      if (!isDisabled) {\n        document.addEventListener(eventName, listener);\n      }\n    });\n\n    return () => {\n      eventsConfig.map((eventConfigItem) => {\n        const [isDisabled, eventName, listener] = eventConfigItem;\n\n        if (!isDisabled) {\n          document.removeEventListener(eventName, listener);\n        }\n      });\n    };\n  }, [eventsConfig]);\n\n  return ref;\n}\n"],"names":["useRef","useCallback","useMemo","useEffect"],"mappings":";;;;AAaA;;;;SAIgB,qBAAqB,CAAC,EAO9B;QANN,WAAW,iBAAA,EACX,YAAY,kBAAA,EACZ,YAAY,kBAAA,EACZ,WAAW,iBAAA,EACX,WAAW,iBAAA,EACX,WAAW,iBAAA;IAEX,IAAM,GAAG,GAAGA,YAAM,CAAC,IAAI,CAAC,CAAC;IAEzB,IAAM,WAAW,GAAGC,iBAAW,CAC7B,UAAC,CAAgB;QACf,IAAI,WAAW,EAAE;YACf,WAAW,CAAC,CAAC,CAAC,CAAC;SAChB;aAAM,IAAI,WAAW,EAAE;YACtB,IAAI,WAAW,CAAC,QAAQ,CAAC,CAAC,CAAC,GAAG,CAAC,EAAE;gBAC/B,WAAW,CAAC,CAAC,CAAC,CAAC;aAChB;SACF;aAAM;YACL,IAAI,CAAC,CAAC,GAAG,KAAK,QAAQ,EAAE;gBACtB,WAAW,CAAC,CAAC,CAAC,CAAC;aAChB;SACF;KACF,EACD,CAAC,WAAW,EAAE,WAAW,EAAE,WAAW,CAAC,CACxC,CAAC;IAEF,IAAM,oBAAoB,GAAGA,iBAAW,CACtC,UAAC,CAA0B;QACzB,IAAI,GAAG,IAAI,GAAG,CAAC,OAAO,EAAE;YACtB,IAAI,CAAE,GAAG,CAAC,OAAgB,CAAC,QAAQ,CAAC,CAAC,CAAC,MAAM,CAAC,EAAE;gBAC7C,WAAW,aAAX,WAAW,uBAAX,WAAW,CAAG,CAAC,CAAC,CAAC;aAClB;SACF;KACF,EACD,CAAC,GAAG,CAAC,OAAO,EAAE,WAAW,CAAC,CAC3B,CAAC;IAEF,IAAM,YAAY,GAAsBC,aAAO,CAC7C,cAAM,OAAA;QACJ,CAAC,YAAY,EAAE,OAAO,EAAE,oBAAoB,CAAC;QAC7C,CAAC,YAAY,EAAE,YAAY,EAAE,oBAAoB,CAAC;QAClD,CAAC,WAAW,EAAE,OAAO,EAAE,WAAW,CAAC;KACpC,GAAA,EACD,CAAC,YAAY,EAAE,YAAY,EAAE,WAAW,EAAE,oBAAoB,EAAE,WAAW,CAAC,CAC7E,CAAC;IAEFC,eAAS,CAAC;QACR,YAAY,CAAC,GAAG,CAAC,UAAC,eAAe;YACxB,IAAA,UAAU,GAAyB,eAAe,GAAxC,EAAE,SAAS,GAAc,eAAe,GAA7B,EAAE,QAAQ,GAAI,eAAe,GAAnB,CAAoB;YAE1D,IAAI,CAAC,UAAU,EAAE;gBACf,QAAQ,CAAC,gBAAgB,CAAC,SAAS,EAAE,QAAQ,CAAC,CAAC;aAChD;SACF,CAAC,CAAC;QAEH,OAAO;YACL,YAAY,CAAC,GAAG,CAAC,UAAC,eAAe;gBACxB,IAAA,UAAU,GAAyB,eAAe,GAAxC,EAAE,SAAS,GAAc,eAAe,GAA7B,EAAE,QAAQ,GAAI,eAAe,GAAnB,CAAoB;gBAE1D,IAAI,CAAC,UAAU,EAAE;oBACf,QAAQ,CAAC,mBAAmB,CAAC,SAAS,EAAE,QAAQ,CAAC,CAAC;iBACnD;aACF,CAAC,CAAC;SACJ,CAAC;KACH,EAAE,CAAC,YAAY,CAAC,CAAC,CAAC;IAEnB,OAAO,GAAG,CAAC;AACb;;;;"}